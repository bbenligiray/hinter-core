# `revise-reports`
You are managing a file-based peer system. When a user asks you to revise report candidates:

## Overview
Revise AI-generated draft report candidates based on user edits and notes before they are finalized and sent to peers. This workflow handles the AI revision process for outgoing reports after the user has reviewed and edited the drafts.

## Report Candidate Location
- Draft report candidates are stored as entries in `entries/` directory
- Filename format: `YYYYMMDDHHMMSS_draft_report_for_[alias].md`
- Status metadata indicates `STATUS: draft`
- Generated by the `draft-reports` workflow
- User has manually reviewed and edited these drafts in their text editor

## Report Candidate Identification
The user may specify report candidates by:
- Target peer alias (e.g., "revise report for alice")
- Partial filename (e.g., "revise draft_report_for_alice")
- Recent reports (e.g., "revise latest report candidates")
- Report timestamp or date
- All pending candidates (e.g., "revise all draft reports")

## Revision Process
1. **Preparation**
   - Execute the `ai/tools/read-entries.sh` script to get all entries for context
   - Ingest the COMPLETE output into your context (do NOT use grep or other command-line tools to filter)
   - Verify the target peer exists in the `peers/` directory

2. **Analyze User Edits**
   - Read the current state of the draft report
   - Identify user edits, notes, and comments
   - Understand the user's intent and direction

3. **Apply Revisions**
   - Implement changes based on user edits and notes
   - Refine content, tone, and structure
   - Remove any metadata or comments meant only for the revision process

4. **Status Update**
   - Update report metadata to `STATUS: revised`
   - Prepare for user's final review before posting

## User Edit Interpretation
- Look for explicit notes or comments in the document (often in HTML comments)
- Analyze differences between the original draft and current state
- Identify sections that were removed, added, or modified
- Understand tone and style adjustments
- Apply consistent changes throughout the document

## Process
Execute read-entries.sh → Verify peer exists → Find edited report → Analyze user changes → Apply revisions → Update status → Confirm success

## Processing Rules
- Search for draft report candidates matching user criteria
- Verify the target peer exists in the `peers/` directory
- If multiple matches found: List all candidates with summaries and ask user to specify
- Analyze user edits and notes to understand revision requirements
- Apply comprehensive revisions based on user direction
- Clean up any revision-related metadata or notes
- Update report status to indicate revision is complete

## Status Management
After revision, reports are marked as:
- **Revised**: `STATUS: revised` - Ready for final review before posting
- User can then approve for posting or request further revisions

## AI Learning Integration
- Track patterns in user edits and preferences
- Learn peer-specific communication styles
- Identify recurring revision patterns
- Improve future draft report generation
- Adapt to user's communication style preferences

## Success Response
On success: "Revised report for {ALIAS} based on your edits. Status updated to 'revised'. Review the changes and use 'post-reports for {ALIAS}' when ready to send."

## Error Cases
- If no draft report candidates exist, inform user and suggest running draft-reports first
- If specified report doesn't exist, list available candidates
- If specified peer doesn't exist in peers/ directory, inform user
- If report file is corrupted, warn user and offer to regenerate
- If user edits are unclear or contradictory, ask for clarification
- If save operation fails, preserve original and note error

## Examples
- User says "revise report for alice" → Find alice's edited draft report, apply revisions based on user edits
- User says "revise all draft reports" → List all edited candidates, revise in sequence
- User says "revise latest report" → Find most recent edited draft report, apply revisions
- After revision: "Revised report for alice based on your edits. Key changes: tone adjusted to be more casual, removed conference details, expanded blockchain project section."

## Integration with Other Workflows
- **From draft-reports**: Receives AI-generated report candidates after user edits
- **To post-reports**: Sends revised reports for distribution after user approval
- **To draft-entries**: Revision patterns influence future AI analysis and suggestions
- **From ingest-reports**: User feedback patterns inform incoming report processing
